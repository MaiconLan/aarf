<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
		"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:p="http://primefaces.org/ui"
	  xmlns:a="http://xmlns.jcp.org/jsf/core">

<ui:composition template="/template/layout.xhtml">
	<ui:define name="conteudo">

		<h:form id="paciente" styleClass="cadastro-pessoa">
			<p:messages id="messages" showDetail="true" autoUpdate="true" />

			<center>
				<h3>Cadastro de Paciente</h3>
			</center>
			<p:panelGrid id="gridPaciente" columns="2">
				<h:panelGrid id="dados" columns="4">
					<p:outputLabel value="Código" for="idPaciente" />
					<h:panelGrid columns="2">
						<p:commandButton icon="fa fa-fw fas fa-search"
										 styleClass="btn-block btn-info btn-flat"
										 action="#{consultaPacienteWebBean.abrirDialogo}"
										 process="@this" update="@none">
							<p:ajax event="dialogReturn"
									listener="#{pacienteWebBean.pacienteSelecionado}" process="@this"
									update="paciente:gridPaciente paciente" />
						</p:commandButton>

						<p:inputText value="#{pacienteWebBean.paciente.idPaciente}"
									 id="idPaciente" placeholder="Código"
									 readonly="true"
									 size="#{applicationWebBean.idSize}" />
					</h:panelGrid>


					<p:outputLabel value="Nome" for="nome" />
					<p:inputText styleClass="input-field col s6" id="nome"
								 size="#{applicationWebBean.inputSize}" placeholder="Nome"
								 value="#{pacienteWebBean.paciente.pessoa.nome}"
								 required="true" requiredMessage="Preenchimento obrigatório" />

					<p:outputLabel for="genero" value="Gênero" />
					<p:selectOneRadio id="genero"
									  value="#{pacienteWebBean.paciente.pessoa.genero}">
						<f:selectItem itemLabel="Masculino" itemValue="M" />
						<f:selectItem itemLabel="Feminino" itemValue="F" />
					</p:selectOneRadio>

					<p:outputLabel value="CPF" for="cpf" />
					<p:inputMask id="cpf" size="#{applicationWebBean.inputSize}"
								 placeholder="CPF" mask="999.999.999-99"
								 value="#{pacienteWebBean.paciente.pessoa.cpf}" />

					<p:outputLabel value="Data de Nascimento" for="nascimento" />
					<p:calendar id="nascimento" size="#{applicationWebBean.inputSize}"
								value="#{pacienteWebBean.paciente.pessoa.nascimento}"
								mask="true" pattern="dd/MM/yyyy" placeholder="Data de Nascimento"
								showOn="button" />

					<p:outputLabel value="Celular" for="celular" />
					<p:inputMask id="celular" size="#{applicationWebBean.inputSize}"
								 placeholder="Celular" mask="(99) ?9 9999-9999 "
								 value="#{pacienteWebBean.paciente.pessoa.celular}" />

					<p:outputLabel value="Telefone" for="residencial" />
					<p:inputMask id="residencial" size="#{applicationWebBean.inputSize}"
								 placeholder="Telefone" mask="(99) 9999-9999"
								 value="#{pacienteWebBean.paciente.pessoa.residencial}" />

					<p:outputLabel value="Profissão" for="profissao" />
					<p:inputText id="profissao"
								 value="#{pacienteWebBean.paciente.pessoa.profissao}"
								 size="#{applicationWebBean.inputSize}" placeholder="Profissão" />

					<p:outputLabel value="Estado Civil" for="estadoCivil" />
					<p:inputText id="estadoCivil" size="#{applicationWebBean.inputSize}"
								 placeholder="Estado Civil"
								 value="#{pacienteWebBean.paciente.pessoa.estadoCivil}" />

					<p:outputLabel value="Escolaridade" for="escolaridade" />
					<p:inputText id="escolaridade" size="#{applicationWebBean.inputSize}"
								 placeholder="Escolaridade"
								 value="#{pacienteWebBean.paciente.pessoa.escolaridade}" />

					<p:outputLabel value="E-mail" for="email" />
					<p:inputText id="email" styleClass="validate" type="email"
								 value="#{pacienteWebBean.paciente.pessoa.email}"
								 size="#{applicationWebBean.inputSize}" placeholder="E-mail" />

					<p:outputLabel value="Primeira Avaliação" for="primeiraAvaliacao" />
					<p:calendar id="primeiraAvaliacao" size="#{applicationWebBean.inputSize}"
								value="#{pacienteWebBean.paciente.primeiraAvaliacao}"
								mask="true" pattern="dd/MM/yyyy" placeholder="Primeira Avaliação"
								showOn="button" />

					<p:outputLabel value="Login:" for="login"/>
					<p:inputText id="login"
								 size="#{applicationWebBean.inputSize}"
								 disabled="#{pacienteWebBean.desabilitarAlteracaoLogin}"
								 value="#{pacienteWebBean.paciente.login.usuario}"/>
					<p:outputLabel value="Senha:" for="senha"/>

					<p:password id="senha"
								size="#{applicationWebBean.inputSize}"
								disabled="#{pacienteWebBean.desabilitarAlteracaoLogin}"
								value="#{pacienteWebBean.paciente.login.senha}"/>

					<p:commandButton value="Alterar Login"
									 id="alterarLogin"
									 icon="fa fa-fw fa-user"
									 styleClass="btn-block btn-info btn-flat"
									 rendered="#{pacienteWebBean.renderizaAlterarLogin()}"
									 action="#{pacienteWebBean.toggleAlterarLogin()}"
									 update="paciente paciente:gridPaciente"
									 immediate="true"/>

					<p:commandButton value="Adicionar Endereço"
									 id="adicionarEndereco"
									 icon="fa fa-fw fa-briefcase"
									 styleClass="btn-block btn-success btn-flat"
									 rendered="#{pacienteWebBean.renderizaAdicionarEndereco()}"
									 action="#{pacienteWebBean.adicionarEndereco()}"
									 update="paciente paciente:panelEndereco"
									 immediate="true"/>

				</h:panelGrid>

				<h:panelGrid id="panelEndereco" columns="2" rendered="#{pacienteWebBean.renderizaPanelEndereco()}">
					<p:outputLabel value=""/>
					<h3>Endereço</h3>
					<p:outputLabel value="CEP:" for="cep"/>

					<p:outputPanel>
						<p:inputMask id="cep" size="#{applicationWebBean.inputSize}"
									 immediate="true"
									 mask="99999-999"
									 value="#{pacienteWebBean.paciente.pessoa.endereco.cep}" />
						<p:commandButton icon="fa fa-fw fas fa-search"
										 styleClass="btn-block btn-info btn-flat"
										 action="#{pacienteWebBean.buscarEndereco()}"
										 process="panelEndereco" update="panelEndereco"/>
					</p:outputPanel>


					<p:outputLabel value="Logradouro:" for="logradouro"/>
					<p:inputText id="logradouro"
								 size="#{applicationWebBean.inputSize}"
								 value="#{pacienteWebBean.paciente.pessoa.endereco.logradouro}"/>

					<p:outputLabel value="Complemento:" for="complemento"/>
					<p:inputText id="complemento"
								 size="#{applicationWebBean.inputSize}"
								 value="#{pacienteWebBean.paciente.pessoa.endereco.complemento}"/>

					<p:outputLabel value="Bairro:" for="bairro"/>
					<p:inputText id="bairro"
								 size="#{applicationWebBean.inputSize}"
								 value="#{pacienteWebBean.paciente.pessoa.endereco.bairro}"/>

					<p:outputLabel value="Cidade:" for="cidade"/>
					<p:inputText id="cidade"
								 size="#{applicationWebBean.inputSize}"
								 value="#{pacienteWebBean.paciente.pessoa.endereco.cidade}"/>

					<p:outputLabel value="Estado:" for="estado"/>
					<p:selectOneMenu id="estado"
									 filter="true" filterMatchMode="contains"
									 value="#{pacienteWebBean.paciente.pessoa.endereco.estado}"
									 immediate="true"
									 converter="omnifaces.SelectItemsConverter">
						<f:selectItem itemLabel="Selecione um Estado" />
						<f:selectItems value="#{pacienteWebBean.estados}"
									   var="estado" itemLabel="#{estado}"
									   itemValue="#{estado}" />
					</p:selectOneMenu>

				</h:panelGrid>
			</p:panelGrid>

			<br />

			<!-- 			Última Consulta -->
			<p:outputPanel id="panelUltimaConsulta"
						   rendered="#{pacienteWebBean.ultimaConsulta.idConsulta != null}">

				<h4>Dados da última consulta</h4>

				<p:panelGrid id="gridUltimaConsulta" columns="2">
					<p:outputLabel value="Data" />
					<p:outputLabel value="#{pacienteWebBean.ultimaConsulta.inicio}">
						<f:convertDateTime locale="pt-BR" pattern="dd/MM/yyyy" />
					</p:outputLabel>

					<p:outputLabel value="Hora" />
					<p:outputLabel
							value="#{pacienteWebBean.ultimaConsulta.inicioTermino()}" />

				</p:panelGrid>
			</p:outputPanel>
			<br />

			<h:panelGrid id="acoes" columns="3"  >
				<p:commandButton value="Salvar" icon="fa fa-fw fa-edit"
								 styleClass="btn-block btn-success btn-flat"
								 action="#{pacienteWebBean.salvar}"
								 update="gridPaciente" />
				<p:spacer height="10"/>
				<p:commandButton value="Limpar" icon="fa fa-fw fa-refresh"
								 actionListener="#{pacienteWebBean.initialize()}"
								 styleClass="btn-block btn-warning btn-flat"
								 update="paciente"
								 process="@this" />
			</h:panelGrid>
		</h:form>
	</ui:define>
</ui:composition>
</html>